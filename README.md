# 10.06. Инцидент-менеджмент

## Краткое описание инцидента

21 октября 2018 года в 22:52 UTC проводились плановые работы, которые привели к потере связи между объектами инфраструктуры на восточном побережье США. Связь была восстановлена за 43 секунды, но сбой вызвал цепочку событий, которые привели к отображению устаревшей информации на сайте github.com и невозможности ее обновления. Работоспособность была восстановлена через 24 часа 11 минут, данные пользователей не были потеряны.

## Предшествующие события

Плановые работы по замене вышедшего из строя оптического оборудования 100G.

## Причина инцидента

Потеря связи между сетевым концентратором и основным центром обработки данных на восточном побережье США, вызванная плановыми работами.

## Воздействие

Сбой базы данных, ставший причиной появления непоследовательной информации на веб-сайте.

## Обнаружение

В 22:54 UTC благодаря сигналам от внутренних систем мониторинга инженеры группы быстрого реагирования определили, что топологии многочисленных кластеров баз данных находятся в непредвиденном состоянии.

## Реакция

Над устранением инцидента работали инженеры группы быстрого реагирования, координатор инцидента и группа реагирования на инциденты. Были вызваны дополнительные инженеры из группы разработки баз данных GitHub. Пользователи были оповещены через твиттер и блог GitHub.

## Восстановление

Базы данных были восстановлены из резервных копий, реплики на обоих сайтах были синхронизированы, возвращена исходная топология, а затем возобновлена обработка заданий в очереди.

## Таймлан

2018 October 21 22:52 UTC
Аварийное переключение кластеров для направления операций записи в центр обработки данных на западном побережье США.

2018 October 21 22:54 UTC
Обнаружение многочисленных сбоев в системах, топологии многочисленных кластеров баз данных находятся в непредвиденном состоянии.

2018 October 21 23:07 UTC
Блокировка внутреннего инструмента развертывания, чтобы предотвратить внесение каких-либо дополнительных изменений. Присвоение сайту желтого, а затем красного статуса.

2018 October 22 00:41 UTC
Запуск резервного копирования всех затронутых кластеров MySQL.

2018 October 22 06:51 UTC
Часть кластеров завершили восстановление из резервных копий в центре обработки данных на восточном побережье США и начали репликацию новых данных с западного побережья.

2018 October 22 07:46 UTC
GitHub опубликовал сообщение в блоге с разъяснением ситуации.

2018 October 22 11:12 UTC
Завершен процесс восстановления первоначального состояния всех БД на восточном побережье.

2018 October 22 16:24 UTC
Завершен процесс реплицирования, восстановлена топология.

2018 October 22 16:45 UTC
Обработка очереди накопившихся событий.

2018 October 22 23:03 UTC
Завершение восстановления, проверка работоспособности всех систем. Статус сайта обновлен до зеленого .

## Последующие действия

Изменение конфигурации Оркестратора.

Ускорение перехода на новый механизм сообщения о статусе обслуживания, т.к. статусы «зеленый», «желтый», «красный» не отображают реальной картины происходящего.

Ускорение перехода на схему обработки трафика GitHub "active/active/active".
